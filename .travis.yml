language: nix
before_script:
  - mkdir urbit
  - cd urbit
  - curl -O https://bootstrap.urbit.org/urbit-v0.10.8-linux64.tgz
  - tar xzf urbit-v0.10.8-linux64.tgz
  - ./urbit-v0.10.8-linux64/urbit -dF zod
script:
  - nix-build
  - nix-shell --run "runghc ./test.hs"
after_script:
  # kill the urbit daemon
  - ps aux|grep "\-d zod"|grep -v grep|tr -s " "|cut -f2 -d" "|xargs kill -9
